<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª</title>

<style>
body {
  margin: 0;
  background: #000;
  color: #fff;
  font-family: Arial;
}

header {
  padding: 10px;
  background: #111;
  display: flex;
  gap: 10px;
}

input {
  flex: 1;
  padding: 10px;
  font-size: 16px;
}

button {
  padding: 10px 15px;
  font-size: 16px;
  cursor: pointer;
}

#videos {
  margin-top: 10px;
}

.video-box {
  width: 100%;
  height: 300px;
  margin-bottom: 20px;
  position: relative;
}

.reward {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.9);
  display: none;
  align-items: center;
  justify-content: center;
  font-size: 24px;
  z-index: 999;
}
</style>
</head>

<body>

<header>
  <input id="youtubeLink" placeholder="Ø¶Ø¹ Ø±Ø§Ø¨Ø· ÙŠÙˆØªÙŠÙˆØ¨ Ù‡Ù†Ø§">
  <button onclick="addVideo()">Ø¥Ø¶Ø§ÙØ©</button>
</header>

<div id="videos"></div>

<div class="reward" id="reward">
  ğŸ‰ Ù…Ø¨Ø±ÙˆÙƒ! Ø­ØµÙ„Øª Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙƒØ§ÙØ£Ø©
</div>

<script src="https://www.youtube.com/iframe_api"></script>

<script>
let playerCount = 0;
let players = {};

function extractVideoId(url) {
  try {
    const u = new URL(url);
    if (u.hostname.includes('youtu.be')) {
      return u.pathname.slice(1);
    }
    return u.searchParams.get('v');
  } catch {
    return null;
  }
}

function addVideo() {
  const link = document.getElementById('youtubeLink').value;
  const videoId = extractVideoId(link);
  if (!videoId) {
    alert('Ø±Ø§Ø¨Ø· ØºÙŠØ± ØµØ§Ù„Ø­');
    return;
  }

  const id = 'player_' + (++playerCount);

  const box = document.createElement('div');
  box.className = 'video-box';
  box.innerHTML = `<div id="${id}"></div>`;
  document.getElementById('videos').prepend(box);

  players[id] = videoId;
}

function onYouTubeIframeAPIReady() {
  setInterval(() => {
    for (let id in players) {
      if (typeof players[id] === 'string') {
        const videoId = players[id];
        players[id] = new YT.Player(id, {
          videoId,
          playerVars: {
            playsinline: 1,
            controls: 1,
            rel: 0
          },
          events: {
            onStateChange: onPlayerStateChange
          }
        });
      }
    }
  }, 500);
}

function onPlayerStateChange(event) {
  if (event.data === YT.PlayerState.ENDED) {
    document.getElementById('reward').style.display = 'flex';
  }
}
</script>

</body>
</html>
